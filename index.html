<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Minecraft JSON Obfuscator (Enhanced) ‚Äî Custom Exclude + Namespace Lock + Blacklist</title>
  <style>
    :root{font-family:system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;}
    body{margin:16px;background:#f6f7fb;color:#111}
    h1{font-size:18px;margin:0 0 8px}
    p{margin:6px 0 12px;color:#333}
    textarea{width:100%;height:200px;padding:10px;border-radius:8px;border:1px solid #d0d4e0;box-sizing:border-box;font-family:monospace;white-space:pre-wrap}
    .row{display:flex;gap:8px;margin:8px 0;flex-wrap:wrap}
    button{padding:8px 12px;border-radius:8px;border:0;background:#2563eb;color:#fff;cursor:pointer}
    button.secondary{background:#6b7280}
    button.danger{background:#ef4444}
    label{display:flex;gap:8px;align-items:center}
    .small{font-size:13px;color:#444}
    footer{margin-top:12px;font-size:12px;color:#666}
    .split{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .excludes, .blacklist{background:#fff;padding:10px;border-radius:8px;border:1px solid #e6e9f2;margin-bottom:12px}
    .exclude-item, .blacklist-item{display:flex;align-items:center;gap:8px;padding:6px 0;border-bottom:1px dashed #eef}
    .exclude-item:last-child, .blacklist-item:last-child{border-bottom:0}
    .pill{background:#eef2ff;padding:4px 8px;border-radius:999px;font-family:monospace;word-break:break-all;max-width:200px;overflow:hidden}
    .pill.blacklist{background:#fef2e6;max-width:300px}
    input[type=text]{padding:8px;border-radius:6px;border:1px solid #ccd3e6;width:100%}
    .settings-section{background:#fff;padding:12px;border-radius:8px;border:1px solid #e6e9f2;margin-bottom:12px}
    .settings-title{font-weight:600;margin-bottom:8px;color:#1f2937}
    .warning{background:#fef3cd;border:1px solid #f59e0b;padding:8px;border-radius:6px;font-size:12px;color:#92400e;margin:8px 0}
    @media(max-width:1000px){.split{grid-template-columns:1fr}textarea{height:160px}}
  </style>
</head>
<body>
  <h1>Minecraft JSON Obfuscator (Enhanced) ‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Ñ + ‡∏•‡πá‡∏≠‡∏Ñ Namespace + Blacklist</h1>
  <p class="small">‡∏ß‡∏≤‡∏á JSON ‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ key/blocks ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ <strong>‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ (exclude)</strong> ‚Äî ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Ñ namespace ‡πÅ‡∏•‡∏∞ blacklist ‡πÅ‡∏ö‡∏ö pattern matching</p>

  <div class="split">
    <div>
      <div class="small">Input JSON</div>
      <textarea id="input" placeholder='‡∏ß‡∏≤‡∏á JSON ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: paste ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå resource/behavior UI)'></textarea>
      
      <div class="settings-section">
        <div class="settings-title">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Obfuscation</div>
        <div class="row">
          <label><input type="radio" name="format" value="pretty" checked> Pretty Format (‡πÅ‡∏ö‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥)</label>
          <label><input type="radio" name="format" value="compact"> Compact Format (‡πÅ‡∏ö‡∏ö‡∏ä‡∏¥‡∏î‡∏Å‡∏±‡∏ô)</label>
        </div>
        <div class="row">
          <label><input type="checkbox" id="keepOrder"> ‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö key ‡πÄ‡∏î‡∏¥‡∏° (‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏©‡∏≤)</label>
          <label><input type="checkbox" id="lockNamespace"> ‡∏•‡πá‡∏≠‡∏Ñ Namespace (‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ namespace.* ‡∏î‡πâ‡∏ß‡∏¢)</label>
        </div>
        <div class="warning" id="namespaceWarning" style="display:none">
          ‚ö†Ô∏è ‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Ñ namespace ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ key ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö "namespace.text" ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏õ‡πá‡∏ô unicode ‡∏î‡πâ‡∏ß‡∏¢ ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∞‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°
        </div>
      </div>

      <div style="margin-top:10px" class="small">
        ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ö‡∏•‡πá‡∏≠‡∏Ñ‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏Å‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™: <code>@style.ui_elements</code>, <code>@button_style.description_panel</code>, <code>@button_style.button_grid</code>
      </div>
    </div>

    <div>
      <div class="small">Exclude Keys (‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™) ‚Äî ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</div>
      <div class="excludes" id="excludesBox">
        <!-- exclude items here -->
      </div>
      <div class="row">
        <input type="text" id="newExclude" placeholder='‡∏û‡∏¥‡∏°‡∏û‡πå key ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: @style.ui_elements'>
        <button id="addExclude">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
      </div>

      <div class="small" style="margin-top:16px">Blacklist Patterns (‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Ñ) ‚Äî ‡πÉ‡∏™‡πà‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î/key ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ obfuscate</div>
      <div class="blacklist" id="blacklistBox">
        <!-- blacklist items here -->
      </div>
      <div class="row">
        <input type="text" id="newBlacklist" placeholder='‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: button_style ‡∏´‡∏£‡∏∑‡∏≠ THIS_CODE_IS_CREATED'>
        <button id="addBlacklist">‡πÄ‡∏û‡∏¥‡πà‡∏° Pattern</button>
      </div>
      <div class="small" style="color:#666;margin-top:4px">
        Blacklist ‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á **keys** ‡πÅ‡∏•‡∏∞ **string values** ‡∏ñ‡πâ‡∏≤‡∏û‡∏ö pattern ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏ß‡πâ‡∏à‡∏∞‡πÑ‡∏°‡πà obfuscate
      </div>

      <div style="margin-top:16px">
        <div class="small">Output (‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ)</div>
        <textarea id="output" readonly placeholder="‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà"></textarea>
        <div class="row" style="margin-top:8px">
          <button id="go">Obfuscate</button>
          <button class="secondary" id="download">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î .json</button>
          <button class="secondary" id="clear">‡∏•‡πâ‡∏≤‡∏á</button>
        </div>
      </div>
    </div>
  </div>

  <footer>
    ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå JSON ‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô \uXXXX escapes (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏´‡∏ô‡∏î) ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏≤‡∏á‡πÅ‡∏ó‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô resource/behavior pack ‡∏Ç‡∏≠‡∏á Minecraft (Bedrock). ‡∏Å‡∏≤‡∏£ obfuscation ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏¢‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ 100%.
    <br><strong>‡πÉ‡∏´‡∏°‡πà:</strong> ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Ñ namespace ‡πÅ‡∏•‡∏∞ blacklist ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
  </footer>

<script>
(function(){
  const input = document.getElementById('input');
  const output = document.getElementById('output');
  const go = document.getElementById('go');
  const downloadBtn = document.getElementById('download');
  const clearBtn = document.getElementById('clear');
  const keepOrder = document.getElementById('keepOrder');
  const lockNamespace = document.getElementById('lockNamespace');
  const namespaceWarning = document.getElementById('namespaceWarning');
  const excludesBox = document.getElementById('excludesBox');
  const blacklistBox = document.getElementById('blacklistBox');
  const newExclude = document.getElementById('newExclude');
  const newBlacklist = document.getElementById('newBlacklist');
  const addExcludeBtn = document.getElementById('addExclude');
  const addBlacklistBtn = document.getElementById('addBlacklist');

  const STORAGE_KEY = 'mc_obfuscator_excludes_v2';
  const BLACKLIST_KEY = 'mc_obfuscator_blacklist_v2';

  // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
  let EXCLUDE_KEYS = [
    "@style.ui_elements",
    "@button_style.description_panel", 
    "@button_style.button_grid"
  ];

  let BLACKLIST_PATTERNS = [
    "button_style",
    "THIS_CODE_IS_CREATED_BY_MINEBIT_STORE",
    "DO_NOT_SELL",
    "DO_NOT_MODIFY",
    "WITHOUT_PERMISSION"
  ];

  // ‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å localStorage
  function loadData(){
    try{
      const excludeRaw = localStorage.getItem(STORAGE_KEY);
      if(excludeRaw){
        const arr = JSON.parse(excludeRaw);
        if(Array.isArray(arr)) EXCLUDE_KEYS = arr;
      }
      const blacklistRaw = localStorage.getItem(BLACKLIST_KEY);
      if(blacklistRaw){
        const arr = JSON.parse(blacklistRaw);
        if(Array.isArray(arr)) BLACKLIST_PATTERNS = arr;
      }
    }catch(e){ console.warn('loadData error', e); }
    renderExcludes();
    renderBlacklist();
  }

  function saveExcludes(){
    try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(EXCLUDE_KEYS)); }
    catch(e){ console.warn('saveExcludes error', e); }
  }

  function saveBlacklist(){
    try{ localStorage.setItem(BLACKLIST_KEY, JSON.stringify(BLACKLIST_PATTERNS)); }
    catch(e){ console.warn('saveBlacklist error', e); }
  }

  function renderExcludes(){
    excludesBox.innerHTML = '';
    if(EXCLUDE_KEYS.length === 0){ 
      excludesBox.innerHTML = '<div class="small">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ exclude</div>'; 
      return; 
    }
    EXCLUDE_KEYS.forEach((k, idx) => {
      const div = document.createElement('div');
      div.className = 'exclude-item';
      const span = document.createElement('div');
      span.className = 'pill';
      span.textContent = k;
      span.title = k; // tooltip ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ï‡πá‡∏°
      const btn = document.createElement('button');
      btn.textContent = '‡∏•‡∏ö';
      btn.className = 'danger';
      btn.style.padding = '4px 8px';
      btn.onclick = () => { 
        EXCLUDE_KEYS.splice(idx,1); 
        saveExcludes(); 
        renderExcludes(); 
      };
      div.appendChild(span);
      const spacer = document.createElement('div'); 
      spacer.style.flex = '1';
      div.appendChild(spacer);
      div.appendChild(btn);
      excludesBox.appendChild(div);
    });
  }

  function renderBlacklist(){
    blacklistBox.innerHTML = '';
    if(BLACKLIST_PATTERNS.length === 0){ 
      blacklistBox.innerHTML = '<div class="small">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ blacklist patterns</div>'; 
      return; 
    }
    BLACKLIST_PATTERNS.forEach((pattern, idx) => {
      const div = document.createElement('div');
      div.className = 'blacklist-item';
      const span = document.createElement('div');
      span.className = 'pill blacklist';
      span.textContent = pattern;
      span.title = pattern;
      const btn = document.createElement('button');
      btn.textContent = '‡∏•‡∏ö';
      btn.className = 'danger';
      btn.style.padding = '4px 8px';
      btn.onclick = () => { 
        BLACKLIST_PATTERNS.splice(idx,1); 
        saveBlacklist(); 
        renderBlacklist(); 
      };
      div.appendChild(span);
      const spacer = document.createElement('div'); 
      spacer.style.flex = '1';
      div.appendChild(spacer);
      div.appendChild(btn);
      blacklistBox.appendChild(div);
    });
  }

  // Event listeners
  addExcludeBtn.addEventListener('click', ()=>{
    const v = newExclude.value.trim();
    if(!v){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå key ‡∏ó‡∏µ‡πà‡∏à‡∏∞ exclude'); return; }
    if(EXCLUDE_KEYS.includes(v)){ alert('‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß'); return; }
    EXCLUDE_KEYS.push(v);
    newExclude.value = '';
    saveExcludes();
    renderExcludes();
  });

  addBlacklistBtn.addEventListener('click', ()=>{
    const v = newBlacklist.value.trim();
    if(!v){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå pattern ‡∏ó‡∏µ‡πà‡∏à‡∏∞ blacklist'); return; }
    if(BLACKLIST_PATTERNS.includes(v)){ alert('Pattern ‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß'); return; }
    BLACKLIST_PATTERNS.push(v);
    newBlacklist.value = '';
    saveBlacklist();
    renderBlacklist();
  });

  // Namespace warning toggle
  lockNamespace.addEventListener('change', ()=>{
    namespaceWarning.style.display = lockNamespace.checked ? 'block' : 'none';
  });

  // Enter key support
  newExclude.addEventListener('keypress', (e)=>{
    if(e.key === 'Enter') addExcludeBtn.click();
  });
  newBlacklist.addEventListener('keypress', (e)=>{
    if(e.key === 'Enter') addBlacklistBtn.click();
  });

  // ‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏ï‡∏£‡∏¥‡∏á‡πÄ‡∏õ‡πá‡∏ô \uXXXX (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö surrogate pair)
  function unicodeEscapeString(s){
    let out = '';
    for(const ch of s){
      const cp = ch.codePointAt(0);
      if(cp <= 0xFFFF){
        out += '\\u' + cp.toString(16).padStart(4,'0');
      } else {
        const v = cp - 0x10000;
        const high = 0xD800 + (v >> 10);
        const low = 0xDC00 + (v & 0x3FF);
        out += '\\u' + high.toString(16).padStart(4,'0') + '\\u' + low.toString(16).padStart(4,'0');
      }
    }
    return out;
  }

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏£‡∏à‡∏∞ obfuscate key ‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
  function shouldObfuscateKey(key){
    if(EXCLUDE_KEYS.includes(key)){
      return false; // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô exclude list
    }
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö blacklist patterns ‡πÉ‡∏ô key
    if(isBlacklisted(key)){
      return false; // ‡∏ñ‡πâ‡∏≤ key ‡∏°‡∏µ blacklist pattern
    }
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö namespace pattern
    if(!lockNamespace.checked){
      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Ñ namespace ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô namespace.* pattern ‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™
      const namespaceMatch = key.match(/^[^.]+\..+$/);
      if(namespaceMatch){
        return false;
      }
    }
    
    return true; // ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏Å‡∏ï‡∏¥
  }

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ string ‡∏´‡∏£‡∏∑‡∏≠ key ‡∏°‡∏µ blacklist pattern ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
  function isBlacklisted(str){
    return BLACKLIST_PATTERNS.some(pattern => str.includes(pattern));
  }

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏õ‡∏•‡∏á namespace key
  function processKey(key){
    // ‡πÉ‡∏ä‡πâ shouldObfuscateKey ‡πÅ‡∏ó‡∏ô
    return key;
  }

  function processObj(obj, depth = 0){
    if(Array.isArray(obj)){
      return obj.map(item => processObj(item, depth));
    }
    if(obj && typeof obj === 'object'){
      const out = {};
      const keys = Object.keys(obj);
      for(const k of keys){
        if(!shouldObfuscateKey(k)){
          // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£ obfuscate (exclude ‡∏´‡∏£‡∏∑‡∏≠ namespace ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Ñ) ‡πÉ‡∏´‡πâ‡∏Ñ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°
          out[k] = obj[k];
        } else {
          // obfuscate key ‡∏õ‡∏Å‡∏ï‡∏¥
          const obfuscatedKey = unicodeEscapeString(k);
          out[obfuscatedKey] = processObj(obj[k], depth + 1);
        }
      }
      return out;
    }
    if(typeof obj === 'string'){
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö blacklist ‡∏Å‡πà‡∏≠‡∏ô obfuscate
      if(isBlacklisted(obj)){
        // ‡∏ñ‡πâ‡∏≤‡∏û‡∏ö blacklist pattern ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏õ‡πá‡∏ô string ‡∏õ‡∏Å‡∏ï‡∏¥
        return obj;
      }
      // ‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏ marker ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ serialize ‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏™‡∏ï‡∏£‡∏¥‡∏á‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß
      return { __mc_obf: true, v: unicodeEscapeString(obj) };
    }
    return obj;
  }

  // Serializer
  function serialize(val, indentLevel){
    const isPretty = document.querySelector('input[name="format"]:checked').value === 'pretty';
    const indent = isPretty ? '  '.repeat(indentLevel) : '';
    const newline = isPretty ? '\n' : '';
    const space = isPretty ? ' ' : '';
    
    if(val === null) return 'null';

    if(val && typeof val === 'object' && val.__mc_obf === true){
      const s = val.v.replace(/"/g,'\\"');
      return '"' + s + '"';
    }

    if(typeof val === 'string'){
      return JSON.stringify(val);
    }

    if(typeof val === 'number' || typeof val === 'boolean') return String(val);

    if(Array.isArray(val)){
      if(val.length === 0) return '[]';
      let parts = val.map(v => (isPretty ? indent + '  ' : '') + serialize(v, indentLevel+1));
      return '[' + newline + parts.join(',' + newline) + newline + indent + ']';
    }

    const keys = Object.keys(val);
    if(keys.length === 0) return '{}';
    let parts = keys.map(k => {
      const keyText = '"' + k.replace(/"/g,'\\"') + '"';
      const v = val[k];
      const ser = serialize(v, indentLevel+1);
      return (isPretty ? indent + '  ' : '') + keyText + ':' + space + ser;
    });
    return '{' + newline + parts.join(',' + newline) + newline + indent + '}';
  }

  function run(){
    let txt = input.value.trim();
    if(!txt){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà JSON ‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡∏•‡∏á‡πÑ‡∏õ'); return; }
    let parsed;
    try{ parsed = JSON.parse(txt); } catch(e){ alert('JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: ' + e.message); return; }
    
    const processed = processObj(parsed);
    const outText = serialize(processed, 0);
    output.value = outText;
  }

  go.addEventListener('click', run);
  clearBtn.addEventListener('click', ()=>{ input.value=''; output.value=''; });
  downloadBtn.addEventListener('click', ()=>{
    if(!output.value) { alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î'); return; }
    const blob = new Blob([output.value], {type:'application/json;charset=utf-8'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); 
    a.href = url; 
    a.download = 'obfuscated.json'; 
    document.body.appendChild(a); 
    a.click(); 
    a.remove(); 
    URL.revokeObjectURL(url);
  });

  // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
  input.value = `{
  "controls": [
    { "@style.ui_elements": {} },
    { "@button_style.description_panel": {} },
    { "@button_style.button_grid": {} },
    { "normalKey": "Hello" },
    { "emojiKey": "üòÄ" },
    { "thaiKey": "‡πÑ‡∏ó‡∏¢" },
    { "namespace.something": "test data" }
  ],
  "button_grid": {
    "type": "stack_panel", 
    "controls": [
      {
        "scrolling_panel@common.scrolling_panel": {
          "$scrolling_content": "button_style.THIS_CODE_IS_CREATED_BY_MINEBIT_STORE__DO_NOT_SELL,_TRADE_OR_MODIFY_IT_WITHOUT_PERMISSIONYjRb38kJqnceT7Rg8Qr7"
        }
      }
    ]
  }
}`;

  loadData();
})();
</script>
</body>
</html>
